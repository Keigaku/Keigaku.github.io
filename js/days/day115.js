// ===========================
// Day 115: 統合管理とスコープ管理
// ===========================
window.Day115 = {
    render(container, dayNum) {
        const dayInfo = Navigation.days[dayNum - 1];
        const sections = `
            <div class="content-section animate-in">
                <h2>🧩 Domain 2: Process の開始 - 統合とスコープ</h2>
                <div class="info-box">
                    <div class="info-box-title">📋 プロセスドメインの中心となる考え方</div>
                    <p>ここからPMPのドメイン2「プロセス群」に入ります。<br>
                    PMの最大の役割は各分野（スコープ、スケジュール、コスト、品質...）をバラバラに管理するのではなく、<strong>全体を統合（Integration）し、トレードオフのバランスを取る</strong>ことです。</p>
                </div>
                
                <h3>プロジェクト憲章 (Project Charter)</h3>
                <p>プロジェクトの存在を公式に承認し、<strong>PMに組織のリソースを割り当てる権限を与える</strong>極めて重要な文書です。（※PMが作成を支援することはありますが、発行・署名するのはスポンサーです）。</p>
                <ul class="feature-list">
                    <li>ハイレベルな要件、マイルストーン、予算が含まれる（詳細は後でWBSでブレイクダウンする）</li>
                    <li>プロジェクトの目的と、成功の基準（ビジネスケースとの整合性）が定義されている</li>
                    <li><strong>PMPの黄金律：</strong>「プロジェクト憲章にない作業は一切行ってはならない（スコープ外）」</li>
                </ul>
            </div>

            <div class="content-section animate-in stagger-1">
                <h2>🎯 スコープ管理とWBS (Work Breakdown Structure)</h2>
                <p>スコープとは「プロジェクトで提供する成果物（プロダクト・スコープ）」と「それを作るための作業（プロジェクト・スコープ）」の全てです。</p>

                <div class="info-box important">
                    <div class="info-box-title">🚨 スコープ・クリープ (Scope Creep) の恐怖</div>
                    <p>スコープ・クリープとは、正式な変更管理プロセスを通さずに、要件がズルズルと肥大化・追加されていく現象のことです。「ついでにこの画面も直してよ」「簡単だからこのボタンも追加して」という顧客の要望に、エンジニアが安易に応えてしまうことで発生します。</p>
                    <p style="color:var(--accent-red); font-weight:bold;">PMはこれを絶対に防がなければなりません。</p>
                </div>

                <h3>WBS (Work Breakdown Structure)</h3>
                <p>チームが行うべき全作業を、階層状に要素分解した図です。<br>
                最下層の単位を<strong>ワーク・パッケージ (Work Package)</strong>と呼び、コストと時間の見積もりの単位となります。</p>

                <table class="styled-table">
                    <thead><tr><th>「金融システムのDB移行計画」のWBS例</th><th>内容</th></tr></thead>
                    <tbody>
                        <tr><td><strong>1.0 移行計画策定</strong></td><td>上位レベル（コントロール・アカウントと呼ばれることもある）</td></tr>
                        <tr><td>┣ 1.1 現行DB分析</td><td></td></tr>
                        <tr><td>┣ 1.2 移行ツール選定</td><td></td></tr>
                        <tr><td><strong>2.0 テスト移行</strong></td><td></td></tr>
                        <tr><td>┣ 2.1 テスト環境構築</td><td></td></tr>
                        <tr><td>┗ 2.2 データ抽出・変換 (ETL)</td><td><strong>【ワーク・パッケージ】</strong>：ここからさらに技術的なアクティビティ（Task）に分解される。</td></tr>
                        <tr><td><em>※WBS辞書</em></td><td>各ワーク・パッケージの詳細（担当、受け入れ基準、予算など）を記述した付属文書。</td></tr>
                    </tbody>
                </table>
                <p><strong>PMPの黄金律：</strong>「WBSに含まれていない作業は、プロジェクトの対象外である」</p>

                <h3>アジャイルにおけるスコープ管理（プロダクト・バックログ）</h3>
                <p>予測型（ウォーターフォール）ではWBSでスコープをガチガチに固定しますが、アジャイルでは<strong>プロダクト・バックログ</strong>として管理します。<br>
                要件（ユーザーストーリー）は常に変化し得ますが、勝手に追加されるのではなく、必ずPO（プロダクトオーナー）が優先順位付けとビジネス価値の評価を行った上でバックログに追加されます。これもスコープ・クリープを防ぐ仕組みの一つです。</p>
            </div>

            <div id="day115-quiz"></div>
        `;
        Navigation.renderDayTemplate(container, dayNum, dayInfo, sections);

        QuizEngine.render('day115-quiz', 'day115-quiz', [
            { question: '【PMP状況問題】予測型アプローチで新証券取引システムのプロジェクトが承認され、あなたはPMに任命されました。しかし、まだあなたにはチームメンバーを招集したり、予算を執行したりする正式な権限が与えられていません。この権限を得るために最も必要な文書は何ですか？', options: ['WBS (Work Breakdown Structure)', 'ビジネスケース (Business Case)', 'プロジェクト・マネジメント計画書 (Project Management Plan)', 'プロジェクト憲章 (Project Charter)'], correct: 3, explanation: 'プロジェクトの存在を公式に承認し、PMに組織の資源・予算を活用する権限（オーソリティ）を与える公式文書は「プロジェクト憲章」です。これが承認（スポンサーによる署名）されて初めて、PMは正式に行動を開始できます。' },
            { question: '【PMP状況問題】顧客の担当者から開発メンバーに対し、「今の仕様のままだと使いにくいので、少しだけ入力フォームの項目を追加してほしい。簡単な修正だからすぐにできるよね？」と直接依頼がありました。エンジニアは「1日で終わるから」と独自判断で実装しようとしています。PMとしてどう対応すべきですか？', options: ['顧客満足度向上のため、そのままエンジニアに実装させる。', 'スコープ・クリープに該当するため即座に作業を中止させ、顧客に「正式な変更要求」を提出するよう手順を案内する。', 'エンジニアを厳しく叱責し、チームから外す。', 'その機能はテストフェーズでこっそり追加する。'], correct: 1, explanation: '「簡単な修正だから」と正式な変更管理プロセスを経ずに要件が追加されていくことをスコープ・クリープと呼びます。これは後々深刻なスケジュール遅延やバグの原因となります。PMはこれを防ぎ、顧客には必ず正式な「変更管理プロセス（変更要求の提出→影響評価→CCBでの承認）」を踏むよう指導しなければなりません。' },
            { question: '予測型プロジェクト（ウォーターフォール）におけるスコープ管理の基礎であり、コストとスケジュールの見積もりの基盤となる「作業を階層的に要素分解したもの」を何と呼びますか？', options: ['Gantt Chart (ガントチャート)', 'RACI Chart', 'WBS (Work Breakdown Structure)', 'Product Backlog (プロダクト・バックログ)'], correct: 2, explanation: 'プロジェクトで提供する全ての作業成果物を階層的に要素分解したものが「WBS」です。WBSの最下層であるワーク・パッケージ単位で、スケジュールやコストの見積もりを行います。アジャイルにおける「プロダクト・バックログ」とは異なります。' },
            { question: 'WBSに含まれる個々のワーク・パッケージの詳細（作業内容、担当者、スケジュール制約、受け入れ基準など）が記述されている文書はどれですか？', options: ['スコープ・ベースライン', 'WBS辞書 (WBS Dictionary)', '要件トレーサビリティ・マトリックス', 'アクティビティ属性'], correct: 1, explanation: 'WBSの図（ツリー構造）だけでは詳細な作業内容や受け入れ基準がわからないため、各ワーク・パッケージの詳細情報をまとめた付属文書として「WBS辞書」を作成します。' },
            { question: '【PMP状況問題】アジャイル・プロジェクトにおいて、スプリント（イテレーション）の途中で、プロダクトオーナーが「市場動向が変わったため、全く新しい機能を今のスプリントに急遽追加したい」と言ってきました。スクラムのルールに基づく適切な対応はどれですか？', options: ['顧客の要望なのですぐにスコープに追加し、開発を始める。', 'POに追加を認めず、現在のスプリントのスコープは絶対に保護されるべきだと説明し、新要件はプロダクト・バックログの適切な優先順位へ追加する。', 'PMの権限でスプリントを強制終了させる。', '残業して両方とも完成させる。'], correct: 1, explanation: 'アジャイルでは要件の変更を歓迎しますが、「進行中のスプリント」のスコープは原則として保護されます（スプリント・ゴールの達成に専念するため）。新しい要件はプロダクト・バックログの適切な優先順位に追加され、次のスプリントプランニングで着手するかどうかが検討されます。' }
        ]);
    }
};
