// ===========================
// Day 122: アジャイル・ハイブリッド開発手法
// ===========================
window.Day122 = {
    render(container, dayNum) {
        const dayInfo = Navigation.days[dayNum - 1];
        const sections = `
            <div class="content-section animate-in">
                <h2>🔄 アジャイルとハイブリッド (Agile & Hybrid Approaches)</h2>
                <div class="info-box">
                    <div class="info-box-title">📋 現代PMPの最重要トピック（試験の50%）</div>
                    <p>堅牢性が求められる金融システムの中核（勘定系）は現在でも予測型（ウォーターフォール）で作られますが、スマートフォンアプリやFinTechサービスなどのフロントエンドは「アジャイル」で作られます。そして現実の大規模プロジェクトは、その両方を組み合わせた**ハイブリッド型**で進むのが標準です。</p>
                </div>
                
                <h3>開発アプローチの連続体</h3>
                <p>プロジェクトにおける「変更の頻度（不確実性）」と「納品（デリバリー）の頻度」によってアプローチを選びます。</p>
                <table class="styled-table text-sm">
                    <thead><tr><th>アプローチ</th><th>変更の頻度</th><th>納品の頻度</th><th>特徴と金融でのユースケース</th></tr></thead>
                    <tbody>
                        <tr><td><strong>予測型 (Predictive)</strong><br>ウォーターフォール等</td><td>低い</td><td>一度きり<br>（最後に一括）</td><td><strong>不確実性：低</strong>。要件が明確で変わらない。コスト・予算管理が厳密。<br>例：基幹システムの更改、新法規制への対応（仕様が法律で固定）</td></tr>
                        <tr><td><strong>反復型 (Iterative)</strong></td><td>高い</td><td>一度きり</td><td><strong>最適化を目指す</strong>。何度もプロトタイプを作り直して完成度を高め、最後に1回でリリースする。<br>例：超複雑なプライシング・アルゴリズムの研究開発</td></tr>
                        <tr><td><strong>インクリメンタル型</strong><br>(Incremental)</td><td>低い</td><td>頻繁</td><td><strong>スピードを目指す</strong>。仕様は決まっているが、できた機能（部分）から少しずつリリースして顧客に価値を届ける。</td></tr>
                        <tr><td><strong>適応型 (Adaptive) / アジャイル</strong></td><td><strong>高い</strong></td><td><strong>頻繁</strong></td><td>上の2つを組み合わせたもの。「価値」を最大化するため、変化を歓迎し、短期間（スプリント）で動くソフトウェアを反復・継続的にリリースする。<br>例：個人向けモバイルバンキング・アプリ。</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="content-section animate-in stagger-1">
                <h2>🛠️ スクラムとカンバンの基礎</h2>
                <p>アジャイルの具体的な実現手法（フレームワーク）として、PMPではスクラムを中心に知識が問われます。</p>

                <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                    <div style="flex:1; background: var(--bg-card); padding: 1.5rem; border: 1px solid var(--border-color); border-radius: var(--radius-md);">
                        <h4 style="color:var(--accent-orange);">スクラム (Scrum)</h4>
                        <ul style="font-size:0.9rem; padding-left:1.2rem;">
                            <li><strong>3つの役割:</strong><br>1. プロダクトオーナー（PO：価値・優先度決定）<br>2. スクラムマスター（SM：障害排除、プロセス守護）<br>3. 開発チーム（開発実行、自己組織化）※これらを総称してスクラムチーム。</li>
                            <li><strong>タイムボックス:</strong><br>スプリント（通常1〜4週間）という固定期間で区切る。</li>
                            <li><strong>レトロスペクティブ:</strong><br>スプリントの最後に行う「プロセスの振り返り（継続的改善）」。PMP頻出。</li>
                        </ul>
                    </div>
                    <div style="flex:1; background: var(--bg-card); padding: 1.5rem; border: 1px solid var(--border-color); border-radius: var(--radius-md);">
                        <h4 style="color:var(--accent-blue);">カンバン (Kanban)</h4>
                        <ul style="font-size:0.9rem; padding-left:1.2rem;">
                            <li><strong>仕掛品（WIP: Work in Progress）の制限:</strong><br>タスクボードの「開発中」列におけるタスク数の上限（例：3つまで）を決め、チームのマルチタスクによるボトルネックや生産性の低下を防ぐコア原則。</li>
                            <li><strong>プルシステム:</strong><br>上からタスクを押し付けるのではなく、手が空いた人がボードからタスクを「引く（Pull）」。フローの最適化重視。</li>
                        </ul>
                    </div>
                </div>

                <div class="info-box important">
                    <div class="info-box-title">⚖️ ハイブリッド・アプローチのマネジメント</div>
                    <p>【典型的なハイブリッドの例】<br>
                    プロジェクト全体の予算承認やマイルストーンスケジュール、ベンダーとの定額契約などは「予測型（ウォーターフォール）」で管理し、システムの実際の開発（設計からテスト）のフェーズ内部だけを「アジャイル（スクラム）」で1ヶ月ごとに回す手法（アジャイル・ウォーターフォール・ハイブリッド）。</p>
                    <p><strong>PMの役割：</strong> アジャイルの「自律的なチームのスピード」と、組織や監査当局が求める「予測型のコンプライアンスドキュメントや進捗報告」のギャップを埋める「翻訳者・橋渡し役」となること。</p>
                </div>
            </div>

            <div id="day122-quiz"></div>
        `;
        Navigation.renderDayTemplate(container, dayNum, dayInfo, sections);

        QuizEngine.render('day122-quiz', 'day122-quiz', [
            { question: '【PMP状況問題】あなたの会社は初めてアジャイル（スクラム）アプローチを導入してモバイル決済アプリを開発しています。スプリントの期間中、顧客の担当者が開発チームのエンジニアに直接「今の仕様より、別の赤いボタンを追加した方が良い。いますぐ実装してくれ」と要求してきました。スクラムマスターとしてどのように対応すべきですか？', options: ['顧客の言うことなので、直ちにエンジニアに実装を指示する。', 'このプロジェクトのプロダクトオーナー（PO）にお願いして、次の開発候補としてプロダクト・バックログに追加し優先順位づけをしてもらうよう、顧客担当者に案内する。', 'スクラムマスターの権限で、その仕様変更を承認する。', '顧客に「アジャイルのルール違反だ」と伝え、エンジニアへの接触を禁止する。'], correct: 2, explanation: 'スクラムにおいて、「何を作るか（プロダクトの価値と優先順位）」を決定する権限と責任は「プロダクトオーナー（PO）」に一元化されています。顧客からの要件追加は直接開発チームが受け取るのではなく、POを通してプロダクトバックログで管理され、スプリントの途中で勝手に差し込まれる（スコープの変更）ことは原則として防がれます。' },
            { question: 'システム開発の中で「レトロスペクティブ（振り返り）」ミーティングの主な目的として最も適切なものはどれですか？', options: ['次のスプリントで開発する機能を見積もるため。', '完成した成果物（ソフトウェア）を関係者にデモして承認（受け入れ）を得るため。', '直近のスプリントを振り返り、「人、人間関係、プロセス、ツール」について何がうまくいき、何を改善できるかを話し合い、継続的改善を実践するため。', 'チームメンバー個人の人事評価とボーナス額を決定するため。'], correct: 3, explanation: 'スプリントの最後に行うレトロスペクティブ（Retrospective）は、アジャイルの背後にある価値基準である「継続的改善（Kaizen）」を実践するための最重要イベントです。プロダクトの仕様ではなく「プロセス（どう働いたか）」を改善します。※成果物のデモは「スプリント・レビュー」で行います。' },
            { question: 'プロセスにおけるボトルネックを特定し、チームのマルチタスク（コンテキストスイッチ）による生産性低下を防ぐために、カンバン（Kanban）手法で最も重視されている原則はどれですか？', options: ['スプリント（固定のタイムボックス）を設定すること', '仕掛品（WIP: Work In Progress）の数を制限すること', '毎朝15分のデイリースタンドアップを行うこと', '詳細なガントチャートを作成すること'], correct: 2, explanation: 'カンバン・ボードの最大の特徴かつ重要原則は、各ステータス列（例：「テスト中」列）に置けるタスクの数に制限（WIP制限）を設けることです。「テスト中」が一杯のときは新しい「開発」を始めず、全員でテストを終わらせることに注力（フローの最適化）します。' },
            { question: '【PMP状況問題】予測型（ウォーターフォール）で進んでいる大規模な基幹系システム統合プロジェクトがあります。しかし、ユーザーインターフェース（UI）の要件について顧客が具体的なイメージを持てておらず、要件定義が完了しそうにありません。プロジェクトを遅延させないために、PMはこのUI部分の開発にどのようなアプローチを採用すべきですか？', options: ['顧客がすべての要件を理解するまでプロジェクト全体を完全に停止する。', '要件が不明確なまま開発を強行し、リリース後の運用フェーズで修正する。', '基幹システム部分は予測型のまま進めつつ、UI部分のみアジャイル（反復型/適応型）を採用して短いサイクルでプロトタイプ作成とフィードバック収集を行う「ハイブリッド・アプローチ」を提案する。', 'UI部分の開発自体をスコープから削除する。'], correct: 3, explanation: 'プロジェクトの特性が部位によって異なる場合（バックエンドは堅確性重視で要件固定、フロントエンドは柔軟性重視など）、両者の良いとこ取りをする「ハイブリッド・アプローチ」が実務でもPMPでも最適な解決策となります。不確実性の高い部分にアジャイルの反復性を適用します。' }
        ]);
    }
};
